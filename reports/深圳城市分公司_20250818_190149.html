
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>深圳城市分公司 交付管理日报</title>
    <!-- Markdown渲染库 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 28px;
            font-weight: 300;
        }
        .header .subtitle {
            margin-top: 10px;
            opacity: 0.9;
            font-size: 16px;
        }
        .content {
            padding: 30px;
        }
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            background: #f8f9ff;
            border-left: 4px solid #667eea;
            padding: 20px;
            border-radius: 4px;
        }
        .card h3 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 18px;
        }
        .card .metric {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }
        .module-section {
            margin-bottom: 40px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }
        .module-header {
            background: #667eea;
            color: white;
            padding: 15px 20px;
            font-size: 20px;
            font-weight: 600;
        }
        .module-content {
            padding: 20px;
        }
        .analysis-text {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 4px;
            margin: 15px 0;
            white-space: pre-line;
            line-height: 1.8;
        }
        /* 表格容器 - 支持水平滑动 */
        .table-container {
            width: 100%;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            max-height: 400px; /* 限制表格最大高度 */
            overflow-y: auto; /* 支持垂直滑动 */
        }
        
        .data-table {
            width: 100%;
            min-width: 800px; /* 设置最小宽度，确保表格不会过度压缩 */
            border-collapse: collapse;
            margin: 0;
            font-size: 14px;
        }
        .data-table th, .data-table td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: left;
        }
        .data-table th {
            background-color: #f5f5f5;
            font-weight: 600;
            color: #333;
        }
        .data-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .footer {
            background: #f5f5f5;
            padding: 20px;
            text-align: center;
            color: #666;
            border-top: 1px solid #e0e0e0;
        }
        
        /* Markdown渲染样式 */
        .markdown-content {
            line-height: 1.8;
            color: #333;
        }
        
        .markdown-content h1, .markdown-content h2, .markdown-content h3 {
            color: #2c3e50;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .markdown-content h2 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
            font-size: 18px;
        }
        
        .markdown-content h3 {
            color: #e74c3c;
            font-size: 16px;
        }
        
        .markdown-content ul, .markdown-content ol {
            padding-left: 20px;
            margin: 10px 0;
        }
        
        .markdown-content li {
            margin: 5px 0;
        }
        
        .markdown-content strong {
            color: #2c3e50;
            font-weight: 600;
        }
        
        .markdown-content code {
            background-color: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #e74c3c;
        }
        
        .markdown-content blockquote {
            border-left: 4px solid #3498db;
            margin: 15px 0;
            padding: 10px 15px;
            background-color: #f8f9fa;
            color: #555;
        }

        /* Markdown表格样式 - 简约风格，确保对齐 */
        .markdown-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            font-size: 14px;
            line-height: 1.5;
            table-layout: fixed; /* 固定表格布局，确保列宽一致 */
        }
        
        .markdown-content th {
            background: #f8f9fa;
            color: #495057;
            padding: 12px 16px;
            text-align: center; /* 表头居中对齐 */
            font-weight: 600;
            font-size: 14px;
            border: 1px solid #dee2e6; /* 添加完整边框 */
            position: sticky;
            top: 0;
            z-index: 10;
            white-space: nowrap; /* 防止表头文字换行 */
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .markdown-content td {
            padding: 12px 16px;
            border: 1px solid #f0f0f0; /* 添加完整边框确保对齐 */
            vertical-align: middle; /* 垂直居中 */
            text-align: center; /* 默认居中对齐 */
            word-wrap: break-word;
            overflow: hidden;
        }
        
        .markdown-content tr:last-child td {
            border-bottom: 1px solid #f0f0f0; /* 保持最后一行的边框 */
        }
        
        .markdown-content tr:hover {
            background-color: #f8f9fa;
        }
        
        /* 表格数据样式 */
        .markdown-content td:first-child {
            font-weight: 500;
            color: #212529;
            text-align: left; /* 第一列左对齐 */
        }
        
        /* 数字列样式 */
        .markdown-content td:nth-child(3) {
            text-align: center; /* 延期天数居中 */
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
            font-weight: 600;
            color: #dc3545; /* 数字用红色突出 */
        }
        
        /* 状态列样式 */
        .markdown-content td:nth-child(4), 
        .markdown-content td:nth-child(5) {
            text-align: center;
        }
        
        /* 表格容器 */
        .markdown-content .table-wrapper {
            border: 1px solid #e9ecef;
            border-radius: 6px;
            overflow-x: auto; /* 支持水平滚动 */
            overflow-y: hidden;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        /* 表格响应式 */
        @media (max-width: 768px) {
            .markdown-content table {
                font-size: 13px;
            }
            
            .markdown-content th,
            .markdown-content td {
                padding: 8px 12px;
            }
        }
        .risk-high { color: #d73027; font-weight: bold; }
        .risk-medium { color: #f46d43; font-weight: bold; }
        .risk-low { color: #74add1; }
        .no-data {
            text-align: center;
            color: #999;
            padding: 40px;
            font-style: italic;
        }
        
        /* 待办事项样式 */
        .todos-section {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin: 30px 0;
            overflow: hidden;
        }
        .todos-header {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        .todos-header h2 {
            margin: 0;
            font-size: 24px;
            font-weight: 600;
        }
        .todos-header .subtitle {
            margin-top: 8px;
            opacity: 0.9;
            font-size: 14px;
        }
        .todos-content {
            padding: 20px;
        }
        .executor-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .executor-header {
            background: #667eea;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .executor-info h3 {
            margin: 0;
            font-size: 18px;
        }
        .executor-info .role {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 2px;
        }
        .supervise-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        .supervise-btn:hover {
            background: #c82333;
        }
        .supervise-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .todo-list {
            padding: 20px;
        }
        .todo-item {
            border-left: 4px solid #ddd;
            padding: 15px;
            margin-bottom: 15px;
            background: #f9f9f9;
            border-radius: 0 4px 4px 0;
        }
        .todo-item.priority-high {
            border-left-color: #dc3545;
            background: #fff5f5;
        }
        .todo-item.priority-medium {
            border-left-color: #ffc107;
            background: #fffdf5;
        }
        .todo-item.priority-low {
            border-left-color: #28a745;
            background: #f5fff5;
        }
        .todo-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .priority-badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        .priority-badge.high {
            background: #dc3545;
            color: white;
        }
        .priority-badge.medium {
            background: #ffc107;
            color: #333;
        }
        .priority-badge.low {
            background: #28a745;
            color: white;
        }
        .todo-description {
            color: #666;
            line-height: 1.5;
            margin-bottom: 10px;
        }
        .todo-meta {
            display: flex;
            gap: 15px;
            font-size: 14px;
            color: #888;
        }
        .todo-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .todos-summary {
            background: #e8f4fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 4px 4px 0;
        }
        .todos-summary h4 {
            color: #1976D2;
            margin: 0 0 10px 0;
        }
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }
        .stat-item {
            text-align: center;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #1976D2;
        }
        .stat-label {
            font-size: 12px;
            color: #666;
            margin-top: 2px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>深圳城市分公司 交付管理日报</h1>
            <div class="subtitle">2025年08月18日 | 开工·施工·收款 综合监控</div>
        </div>
        
        <div class="content">
            
            
            
            <div class="alert-section" style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
                <div class="alert-title" style="color: #d73027; margin-bottom: 10px; font-weight: bold;">🚨 异常总计</div>
                <div class="alert-content markdown-content" data-markdown="当前业务数据异常主要集中在工地延期和收款超期两大板块。开工管理方面，存在**7个工地延期超80天**，其中最长延期达**143天（林先生，何宇）**，且均为“未达交付条件”状态，销售侧资料收集滞后严重。工期管理中，单品焕新及全屋装修项目在拆除与保护、水电、竣工等阶段普遍延期，最高延期达**54天（熊小梅，马圣）**和**49天（美女，李洁）**，影响整体交付进度。收款管理板块，超大金额订单超期未回款尤为突出，典型如**祝先生超期20.36万元**，且多名负责人名下存在批量超期订单，需重点关注。"></div>
            </div>
            
            
            
            <div class="module-section">
                <div class="module-header">
                    开工管理
                </div>
                <div class="module-content">
                    
                    <div style="margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #eee;">
                        <h4 style="color: #667eea; margin-bottom: 15px;">未开工工地延期</h4>

                        
                        <div class="key-metrics" style="background: #f0f8ff; border-left: 4px solid #2196F3; padding: 12px; margin: 15px 0;">
                            <h5 style="margin: 0 0 8px 0; color: #1976D2;">🔍 异常洞察</h5>
                            <div class="markdown-content" data-markdown="**问题1：开工延期严重，销售侧未达交付条件工地集中，部分延期超100天**  
目前有**7个工地延期超80天**，均为“未达交付条件”状态，涉及销售人员何宇、晏文、唐翠丽、刘洋、吕乐乐、陈华超、刘嘉。最长延期达**143天（林先生，何宇）**，其次有**118天（谌先生，晏文）**、**112天（孙顺良，唐翠丽）**等。  
这些工地均未完成客户资料、首款、效果图，导致无法进入交付流程。

解决方案：  
督办【销售】何宇、晏文、唐翠丽、刘洋、吕乐乐、陈华超、刘嘉，尽快完成对应客户（林先生、谌先生、孙顺良、贾蕾、田辉、陈春枚、吴春香）的客户资料、首款、效果图，推动工地进入交付流程。

| 客户姓名 | 销售姓名 | 延期天数 | 开工状态     | 主要责任方 |
|----------|----------|----------|--------------|------------|
| **林先生**   | **何宇**      | **143**      | 未达交付条件 | 销售责任    |
| **谌先生**   | **晏文**      | **118**      | 未达交付条件 | 销售责任    |
| **孙顺良**   | **唐翠丽**    | **112**      | 未达交付条件 | 销售责任    |
| **贾蕾**     | **刘洋**      | **111**      | 未达交付条件 | 销售责任    |
| **田辉**     | **吕乐乐**    | **100**      | 未达交付条件 | 销售责任    |
| **陈春枚**   | **陈华超**    | **92**       | 未达交付条件 | 销售责任    |
| **吴春香**   | **刘嘉**      | **80**       | 未达交付条件 | 销售责任    |

---

**问题2：部分工地延期较长，销售侧需加快交付申请进度**  
有**2个工地处于“待申请交付”状态，延期31天**，分别由销售陆诗韵和余月玲负责，客户为李小姐和王聪。  
工地已满足交付条件但未及时提交交付申请，影响后续流程。

解决方案：  
督办【销售】陆诗韵、余月玲，立即为客户李小姐、王聪提交交付申请，缩短工地等待周期。

| 客户姓名 | 销售姓名 | 延期天数 | 开工状态      | 主要责任方 |
|----------|----------|----------|---------------|------------|
| **李小姐**   | **陆诗韵**      | **31**       | 待申请交付   | 销售责任    |
| **王聪**     | **余月玲**      | **31**       | 待申请交付   | 销售责任    |

---

**问题3：销售侧多单延期40天以上，需加快客户资料、首款、效果图收集**  
除上述超长延期外，仍有**5个工地延期40天以上**，均为“未达交付条件”，涉及销售肖娜娜、林嘉强、张慧雯、陈凯、金杜雨。  
如谭建华（肖娜娜）延期**39天**，欧阳女士（林嘉强）延期**38天**，谢丽雅（张慧雯）延期**76天**等。

解决方案：  
督办【销售】肖娜娜、林嘉强、张慧雯、陈凯、金杜雨，尽快完成客户谭建华、欧阳女士、谢丽雅、余芳芳、叶派璋的客户资料、首款、效果图，推动工地进入交付流程。

| 客户姓名 | 销售姓名 | 延期天数 | 开工状态     | 主要责任方 |
|----------|----------|----------|--------------|------------|
| **谢丽雅**   | **张慧雯**    | **76**       | 未达交付条件 | 销售责任    |
| **余芳芳**   | **陈凯**      | **69**       | 未达交付条件 | 销售责任    |
| **沈萍**     | **陈华超**    | **64**       | 未达交付条件 | 销售责任    |
| **谭建华**   | **肖娜娜**    | **39**       | 未达交付条件 | 销售责任    |
| **欧阳女士** | **林嘉强**    | **38**       | 未达交付条件 | 销售责任    |
| **叶派璋**   | **金杜雨**    | **23**       | 未达交付条件 | 销售责任    |

---

**督办指令总结**  
请销售负责人针对延期工地逐一督促相关销售人员，按客户名单完成客户资料、首款、效果图收集，及时提交交付申请，缩短工地等待周期。对于“待申请交付”状态工地，务必本周内完成交付申请提交。"></div>
                        </div>
                        

                        

                        
                    </div>
                    
                </div>
            </div>
            
            <div class="module-section">
                <div class="module-header">
                    工期管理
                </div>
                <div class="module-content">
                    
                    <div style="margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #eee;">
                        <h4 style="color: #667eea; margin-bottom: 15px;">在施工延期分析</h4>

                        
                        <div class="key-metrics" style="background: #f0f8ff; border-left: 4px solid #2196F3; padding: 12px; margin: 15px 0;">
                            <h5 style="margin: 0 0 8px 0; color: #1976D2;">🔍 异常洞察</h5>
                            <div class="markdown-content" data-markdown="**问题1：多单品焕新项目延期严重，拆除与保护阶段拖延明显**  
目前有多位客户的单品焕新项目在“拆除与保护”阶段延期超过20天，最高达**42天（李先生）**。此环节本应快速推进，但实际工期普遍远超合同工期，影响后续进度。

| 客户姓名 | 超级队长 | 合同工期 | 实际工期 | 延期天数 | 当前施工阶段 |
|:---:|:---:|:---:|:---:|:---:|:---:|
| 李莉 | 周传武 | 35 | 58 | **23** | 拆除与保护 |
| 张先生 | 陈智 | 35 | 56 | **21** | 拆除与保护 |
| 李小鹏 | 王加雄 | 25 | 48 | **23** | 拆除与保护 |
| 沈姐 | 韩东方 | 15 | 50 | **35** | 拆除与保护 |
| 李先生 | 张杰 | 20 | 62 | **42** | 拆除与保护 |
| 周女士 | 李应求 | 10 | 41 | **31** | 拆除与保护 |

解决方案：督办【交付管理 刘晨晨】【超级队长 周传武、陈智、王加雄、韩东方、张杰、李应求】加快推进【李莉、张先生、李小鹏、沈姐、李先生、周女士】的拆除与保护阶段施工，务必在一周内完成节点验收。

---

**问题2：全屋装修项目延期突出，水电阶段进度滞后**  
全屋装修项目在水电阶段延期显著，尤其是**熊小梅**的项目，延期高达**54天**，远超合同工期，需重点关注。

| 客户姓名 | 超级队长 | 合同工期 | 实际工期 | 延期天数 | 当前施工阶段 |
|:---:|:---:|:---:|:---:|:---:|:---:|
| 罗君慧 | 王加雄 | 65 | 92 | **27** | 水电 |
| 熊小梅 | 马圣 | 4 | 58 | **54** | 水电 |

解决方案：督办【交付管理 刘晨晨】【超级队长 王加雄、马圣】加速【罗君慧、熊小梅】水电阶段施工，优先解决材料、人员到场问题，确保下周完成水电验收。

---

**问题3：局部及全屋装修竣工阶段延期，交付收尾不及时**  
部分局部及全屋装修项目已到竣工阶段，但延期仍达**21天（杨橹）**，影响客户交付体验。

| 客户姓名 | 超级队长 | 合同工期 | 实际工期 | 延期天数 | 当前施工阶段 |
|:---:|:---:|:---:|:---:|:---:|:---:|
| 杨橹 | 倪文兵 | 70 | 91 | **21** | 竣工 |

解决方案：督办【交付管理 舒翔】【超级队长 倪文兵】立即完成【杨橹】竣工验收，确保本周交付。

---

**问题4：单品焕新竣工阶段严重延期，交付流程需提速**  
单品焕新项目在竣工阶段延期高达**49天（美女）**，交付流程明显滞后，需重点督促。

| 客户姓名 | 超级队长 | 合同工期 | 实际工期 | 延期天数 | 当前施工阶段 |
|:---:|:---:|:---:|:---:|:---:|:---:|
| 美女 | 李洁 | 7 | 56 | **49** | 竣工 |

解决方案：督办【交付管理 刘晨晨】【超级队长 李洁】加快【美女】项目竣工交付，务必本周完成所有收尾工作。

---

**问题5：部分项目中期及其他阶段延期，整体进度管控需加强**  
全屋装修及单品焕新项目在中期和其他阶段也存在较大延期，影响整体交付节奏。

| 客户姓名 | 超级队长 | 合同工期 | 实际工期 | 延期天数 | 当前施工阶段 |
|:---:|:---:|:---:|:---:|:---:|:---:|
| 林鹏禹 | 郑祖海 | 65 | 95 | **30** | 中期 |
| 赵军 | 韩东方 | 30 | 60 | **30** | 其他 |

解决方案：督办【交付管理 舒翔、刘晨晨】【超级队长 郑祖海、韩东方】加快【林鹏禹、赵军】项目中期及其他阶段施工，明确节点计划，提升整体进度。

---

**重点督办建议**  
针对延期超过**30天**的项目，建议交付管理负责人每日跟进进度，必要时组织现场专项会议，确保各超级队长落实整改措施，提升整体交付效率。"></div>
                        </div>
                        

                        

                        
                    </div>
                    
                </div>
            </div>
            
            <div class="module-section">
                <div class="module-header">
                    收款管理
                </div>
                <div class="module-content">
                    
                    <div style="margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #eee;">
                        <h4 style="color: #667eea; margin-bottom: 15px;">超期收款分析</h4>

                        
                        <div class="key-metrics" style="background: #f0f8ff; border-left: 4px solid #2196F3; padding: 12px; margin: 15px 0;">
                            <h5 style="margin: 0 0 8px 0; color: #1976D2;">🔍 异常洞察</h5>
                            <div class="markdown-content" data-markdown="**问题1：超大金额超期未回款，销售责任人未提交任务跟进**

目前有多笔超期金额超过**10万元**的订单，且均为第1期款，销售责任人未提交任何收款跟进记录。典型客户包括：祝先生（**20.36万**）、孙顺良（**9.16万**）、杨培华（**8.02万**）、林女士（**9.14万**）、陈春枚（**6.50万**）、张先生（**4.50万**）等。此类订单风险极高，需重点督办。

解决方案：督办【销售人员】王宜丰、唐翠丽、杨培华、晏文、陈华超、马雷等，立即完成【祝先生、孙顺良、杨培华、林女士、陈春枚、张先生】等客户的第1期款收款跟进任务，并补充收款进展记录。

| 客户姓名 | 超期金额（元） | 销售姓名 | 当前待收款期数 | 最近一次提交任务时间 |
|---------|--------------|----------|----------------|--------------------|
| **祝先生** | **203,583.25** | 王宜丰   | 1              | 无                 |
| **孙顺良** | **91,622.83**  | 唐翠丽   | 1              | 无                 |
| **杨培华** | **80,209.13**  | 杨培华   | 1              | 无                 |
| **林女士** | **91,417.64**  | 晏文     | 1              | 无                 |
| **陈春枚** | **65,039.86**  | 陈华超   | 1              | 无                 |
| **张先生** | **45,041.84**  | 马雷     | 1              | 无                 |

---

**问题2：交付负责人期款超期，部分已提交任务但原因不明或未完善**

部分订单为交付负责人负责的后续期款收款，已提交任务但仅填写“其他”原因，未详细说明具体障碍，且未有实质性进展。典型客户如沈姐、张先生、杨橹、罗洁、李永强等。

解决方案：督办【交付负责人】舒翔、刘晨晨等，补充完善【沈姐、张先生、杨橹、罗洁、李永强】等客户的收款超期原因，并推动收款进度，要求下次任务提交时明确具体障碍及解决措施。

| 客户姓名 | 超期金额（元） | 交付负责人 | 当前待收款期数 | 最近一次提交任务时间 | 超期原因 |
|---------|--------------|------------|----------------|---------------------|----------|
| 沈姐    | 1,499.01     | 刘晨晨     | 1              | 2025-06-11 09:28:16 | 其他     |
| 张先生  | 3,997.67     | 刘晨晨     | 1              | 2025-08-18 18:05:06 | 其他     |
| 杨橹    | 8,868.58     | 舒翔       | 2              | 2025-06-11 09:37:56 | 其他     |
| 罗洁    | 13,581.11    | 舒翔       | 1              | 2025-06-11 09:30:58 | 其他     |
| 李永强  | 18,474.81    | 舒翔       | 1              | 2025-06-11 09:39:25 | 其他     |

---

**问题3：多笔小额订单长期超期，责任人未跟进**

存在大量小额订单（金额低于**5,000元**）长期超期，销售或交付负责人均未提交任何收款跟进记录，易被忽视但影响整体回款率。典型客户如吴春香（**6.50元**）、李春梅（**443.57元**）、黄芩（**500元**）、手机用户9986（**2,725.28元**）等。

解决方案：督办【销售人员/交付负责人】秦琰、王伟远、刘嘉等，完成【吴春香、李春梅、黄芩、手机用户9986】等客户的收款跟进任务，避免小额订单长期积压。

| 客户姓名 | 超期金额（元） | 销售/交付负责人 | 当前待收款期数 | 最近一次提交任务时间 |
|---------|--------------|------------------|----------------|--------------------|
| 吴春香  | 6.50         | 刘嘉             | 1              | 无                 |
| 李春梅  | 443.57       | 无                | 1              | 无                 |
| 黄芩    | 500.00       | 王伟远           | 1              | 无                 |
| 手机用户9986 | 2,725.28 | 秦琰             | 1              | 无                 |

---

**问题4：部分订单多期超期，责任人未及时跟进**

有部分客户存在多期（2期及以上）超期未回款，责任人未及时提交任务。典型客户如符小姐（2期，**17,022.58元**）、杨橹（2期，**8,868.58元**）、赵宁（2期，**38,060.80元**）。

解决方案：督办【交付负责人】舒翔，完成【符小姐、杨橹、赵宁】等客户的多期收款跟进任务，优先解决多期积压问题。

| 客户姓名 | 超期金额（元） | 交付负责人 | 当前待收款期数 | 最近一次提交任务时间 |
|---------|--------------|------------|----------------|---------------------|
| 符小姐  | 17,022.58    | 舒翔       | 2              | 无                  |
| 杨橹    | 8,868.58     | 舒翔       | 2              | 2025-06-11 09:37:56 |
| 赵宁    | 38,060.80    | 舒翔       | 2              | 无                  |

---

**问题5：部分销售/交付负责人重复超期订单，需重点关注**

部分销售或交付负责人名下存在多笔超期订单，且均未提交任务或进展缓慢。典型如裴静路、晏文、陈华超、舒翔等，需重点督办其名下所有超期订单，防止批量积压。

解决方案：督办【销售人员/交付负责人】裴静路、晏文、陈华超、舒翔，梳理并完成其名下所有客户的收款跟进任务，定期汇报进展。

| 负责人   | 超期订单数 | 典型客户          | 总超期金额（元） |
|---------|-----------|-------------------|-----------------|
| 裴静路   | 6         | 殷梅、杨先生等    | >10万            |
| 晏文     | 2         | 谌先生、林女士    | >16万            |
| 陈华超   | 3         | 陈春枚、沈萍等    | >16万            |
| 舒翔     | 6         | 符小姐、杨橹等    | >10万            |

---

**结论：**
当前收款超期问题集中在高金额订单未跟进、交付负责人任务不完善、小额订单长期积压、多期超期未处理，以及部分负责人批量超期。建议分批督办，优先处理高金额和多期超期订单，所有责任人需补充收款进展记录，确保任务闭环。"></div>
                        </div>
                        

                        

                        
                    </div>
                    
                </div>
            </div>
            
            
            
            <div class="todos-section">
                <div class="todos-header">
                    <h2>📋 AI生成执行人待办事项</h2>
                    <div class="subtitle">基于数据分析结果，为各执行人生成具体可执行的待办事项</div>
                </div>
                <div class="todos-content">
                    
                    <div class="todos-summary">
                        <h4>📊 待办事项概览</h4>
                        <div class="summary-stats">
                            <div class="stat-item">
                                <div class="stat-value">17</div>
                                <div class="stat-label">执行人数</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">24</div>
                                <div class="stat-label">待办事项</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">17</div>
                                <div class="stat-label">高优先级</div>
                            </div>
                        </div>
                    </div>
                    
                    
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>何宇</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('05138309', '何宇')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未达交付条件订单开工
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对林先生订单（4250316523920871933583360），已延期143天，需在3天内与客户沟通，推动达成交付条件，完成开工准备。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-21</span>
                                    <span>📂 开工管理</span>
                                    
                                    <span>🏗️ 林先生订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>晏文</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('00765655', '晏文')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未达交付条件订单开工
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对谌先生订单（4250322526076928663412736），已延期118天，需在3天内与客户沟通，推动达成交付条件，完成开工准备。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-21</span>
                                    <span>📂 开工管理</span>
                                    
                                    <span>🏗️ 谌先生订单</span>
                                    
                                </div>
                            </div>
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未回款订单收款
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对谌先生订单（4250322526076928663412736），超30天未回款70979.27元，需在5天内联系客户并完成第一期收款。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 收款管理</span>
                                    
                                    <span>🏗️ 谌先生订单</span>
                                    
                                </div>
                            </div>
                            
                            <div class="todo-item priority-medium">
                                <div class="todo-title">
                                    跟进未达交付条件订单开工
                                    <span class="priority-badge medium">
                                        中优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对林女士订单（4250322526141798935101440），已延期85天，需在5天内与客户沟通，推动达成交付条件，完成开工准备。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 开工管理</span>
                                    
                                    <span>🏗️ 林女士订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>唐翠丽</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('05156572', '唐翠丽')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未达交付条件订单开工
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对孙顺良订单（4250405531125317751001088），已延期112天，需在3天内与客户沟通，推动达成交付条件，完成开工准备。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-21</span>
                                    <span>📂 开工管理</span>
                                    
                                    <span>🏗️ 孙顺良订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>刘洋</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('liuy418', '刘洋')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未达交付条件订单开工
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对贾蕾订单（4250407531868633631281152），已延期111天，需在3天内与客户沟通，推动达成交付条件，完成开工准备。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-21</span>
                                    <span>📂 开工管理</span>
                                    
                                    <span>🏗️ 贾蕾订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>吕乐乐</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('01086934', '吕乐乐')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未达交付条件订单开工
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对田辉订单（4250426538845754220064768），已延期100天，需在3天内与客户沟通，推动达成交付条件，完成开工准备。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-21</span>
                                    <span>📂 开工管理</span>
                                    
                                    <span>🏗️ 田辉订单</span>
                                    
                                </div>
                            </div>
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未回款订单收款
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对田辉订单（4250426538845754220064768），超30天未回款27814.46元，需在5天内联系客户并完成第一期收款。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 收款管理</span>
                                    
                                    <span>🏗️ 田辉订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>陈华超</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('05153717', '陈华超')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未达交付条件订单开工
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对陈春枚订单（4250518546706131804884992），已延期92天，需在3天内与客户沟通，推动达成交付条件，完成开工准备。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-21</span>
                                    <span>📂 开工管理</span>
                                    
                                    <span>🏗️ 陈春枚订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>刘嘉</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('05173107', '刘嘉')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-medium">
                                <div class="todo-title">
                                    跟进未达交付条件订单开工
                                    <span class="priority-badge medium">
                                        中优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对吴春香订单（4250524548818584680435712），已延期80天，需在5天内与客户沟通，推动达成交付条件，完成开工准备。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 开工管理</span>
                                    
                                    <span>🏗️ 吴春香订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>张慧雯</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('05173164', '张慧雯')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-medium">
                                <div class="todo-title">
                                    跟进未达交付条件订单开工
                                    <span class="priority-badge medium">
                                        中优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对谢丽雅订单（4250610554997847045693440），已延期76天，需在5天内与客户沟通，推动达成交付条件，完成开工准备。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 开工管理</span>
                                    
                                    <span>🏗️ 谢丽雅订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>陈凯</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('00785911', '陈凯')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-medium">
                                <div class="todo-title">
                                    跟进未达交付条件订单开工
                                    <span class="priority-badge medium">
                                        中优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对余芳芳订单（4250419536162864445206528），已延期69天，需在5天内与客户沟通，推动达成交付条件，完成开工准备。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 开工管理</span>
                                    
                                    <span>🏗️ 余芳芳订单</span>
                                    
                                </div>
                            </div>
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未回款订单收款
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对余芳芳订单（4250419536162864445206528），超30天未回款21186.93元，需在5天内联系客户并完成第一期收款。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 收款管理</span>
                                    
                                    <span>🏗️ 余芳芳订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>王宜丰</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('05082861', '王宜丰')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未回款订单收款
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对祝先生订单（4250322525958027631845376），超30天未回款203583.25元，需在5天内联系客户并完成第一期收款。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 收款管理</span>
                                    
                                    <span>🏗️ 祝先生订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>张海云</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('05200211', '张海云')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未回款订单收款
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对倪佳订单（4250705564186391781773312），超30天未回款74131.30元，需在5天内联系客户并完成第一期收款。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 收款管理</span>
                                    
                                    <span>🏗️ 倪佳订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>尹邵丰</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('01180231', '尹邵丰')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未回款订单收款
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对徐苗苗订单（4250412533622372780105728），超30天未回款29141.64元，需在5天内联系客户并完成第一期收款。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 收款管理</span>
                                    
                                    <span>🏗️ 徐苗苗订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>刘娜</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('liun29', '刘娜')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未回款订单收款
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对刘娜订单（4250421536899614268399616），超30天未回款43364.38元，需在5天内联系客户并完成第一期收款。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 收款管理</span>
                                    
                                    <span>🏗️ 刘娜订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>何孝妹</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('01162244', '何孝妹')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未回款订单收款
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对吕先生订单（4250408532206760602345472），超30天未回款18223.41元，需在5天内联系客户并完成第一期收款。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 收款管理</span>
                                    
                                    <span>🏗️ 吕先生订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="executor-card">
                        <div class="executor-header">
                            <div class="executor-info">
                                <h3>裴静路</h3>
                                <div class="role">销售</div>
                            </div>
                            <button class="supervise-btn" 
                                    onclick="superviseTodos('01167429', '裴静路')">
                                🚀 一键督办
                            </button>
                        </div>
                        <div class="todo-list">
                            
                            <div class="todo-item priority-high">
                                <div class="todo-title">
                                    跟进未回款订单收款
                                    <span class="priority-badge high">
                                        高优先级
                                    </span>
                                </div>
                                <div class="todo-description">针对殷梅订单（4250613556166030871969792），超30天未回款1998.00元，需在5天内联系客户并完成第一期收款。</div>
                                <div class="todo-meta">
                                    <span>⏰ 2025-08-23</span>
                                    <span>📂 收款管理</span>
                                    
                                    <span>🏗️ 殷梅订单</span>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                </div>
            </div>
            
        </div>
        
        <div class="footer">
            生成时间：2025-08-18 19:01:49 | AI自动日报推送系统
        </div>
    </div>
    
    <script>
        // 修复Markdown表格格式
        function fixMarkdownTable(markdownText) {
            if (!markdownText) return markdownText;
            
            // 分行处理
            const lines = markdownText.split('\n');
            const fixedLines = [];
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                // 检查是否是表格行（包含 | 符号）
                if (line.includes('|')) {
                    // 移除行首行尾的 |，然后重新格式化
                    let cells = line.split('|').map(cell => cell.trim()).filter(cell => cell !== '');
                    
                    // 确保每个单元格都有内容，空的用 - 填充
                    cells = cells.map(cell => cell === '' ? '-' : cell);
                    
                    // 重新构建表格行
                    const fixedLine = '| ' + cells.join(' | ') + ' |';
                    fixedLines.push(fixedLine);
                } else {
                    fixedLines.push(line);
                }
            }
            
            return fixedLines.join('\n');
        }
        
        // 修复表格对齐问题
        function fixTableAlignment(table) {
            if (!table) return;
            
            // 获取表头和数据行
            const thead = table.querySelector('thead');
            const tbody = table.querySelector('tbody');
            
            if (!thead || !tbody) return;
            
            const headerCells = thead.querySelectorAll('th');
            const dataRows = tbody.querySelectorAll('tr');
            
            // 确保每行的单元格数量与表头一致
            const expectedCellCount = headerCells.length;
            
            dataRows.forEach(row => {
                const cells = row.querySelectorAll('td');
                
                // 如果单元格数量不匹配，添加空单元格
                if (cells.length < expectedCellCount) {
                    const missingCount = expectedCellCount - cells.length;
                    for (let i = 0; i < missingCount; i++) {
                        const emptyCell = document.createElement('td');
                        emptyCell.textContent = '-';
                        emptyCell.style.color = '#999';
                        row.appendChild(emptyCell);
                    }
                }
                
                // 移除多余的单元格
                if (cells.length > expectedCellCount) {
                    for (let i = cells.length - 1; i >= expectedCellCount; i--) {
                        cells[i].remove();
                    }
                }
            });
            
            // 设置表格的最小宽度，确保显示完整
            table.style.minWidth = '100%';
            table.style.width = 'auto';
        }

        // Markdown渲染功能
        function renderMarkdown() {
            console.log('开始渲染Markdown内容...');
            const markdownElements = document.querySelectorAll('.markdown-content[data-markdown]');
            console.log(`找到 ${markdownElements.length} 个Markdown元素`);
            
            markdownElements.forEach((element, index) => {
                let markdownText = element.getAttribute('data-markdown');
                console.log(`元素 ${index + 1} 的原始内容长度: ${markdownText ? markdownText.length : 0}`);
                
                if (markdownText && markdownText.trim()) {
                    if (typeof marked !== 'undefined') {
                        try {
                            // 清理Markdown代码块标记
                            markdownText = markdownText.trim();
                            if (markdownText.startsWith('```markdown')) {
                                markdownText = markdownText.substring(11).trim();
                            }
                            if (markdownText.startsWith('```')) {
                                markdownText = markdownText.substring(3).trim();
                            }
                            if (markdownText.endsWith('```')) {
                                markdownText = markdownText.substring(0, markdownText.length - 3).trim();
                            }
                            
                            // 修复表格格式问题
                            markdownText = fixMarkdownTable(markdownText);
                            
                            const htmlContent = marked.parse(markdownText);
                            element.innerHTML = htmlContent;
                            
                            // 为表格添加简约样式容器和修复对齐
                            const tables = element.querySelectorAll('table');
                            tables.forEach((table, tableIndex) => {
                                // 修复表格结构
                                fixTableAlignment(table);
                                
                                // 添加容器
                                if (!table.closest('.table-wrapper') && !table.closest('.table-container')) {
                                    const wrapper = document.createElement('div');
                                    wrapper.className = 'table-wrapper';
                                    table.parentNode.insertBefore(wrapper, table);
                                    wrapper.appendChild(table);
                                }
                            });
                            
                            console.log(`元素 ${index + 1} Markdown渲染成功，处理了 ${tables.length} 个表格`);
                        } catch (error) {
                            console.warn(`元素 ${index + 1} Markdown渲染失败:`, error);
                            // 如果渲染失败，显示清理后的文本，保持换行
                            element.innerHTML = markdownText.replace(/\n/g, '<br>');
                        }
                    } else {
                        console.warn('marked库未加载，使用简单格式化');
                        // 如果marked库未加载，进行简单的格式化
                        let formattedText = markdownText
                            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')  // 粗体
                            .replace(/\*(.*?)\*/g, '<em>$1</em>')              // 斜体
                            .replace(/^### (.*$)/gim, '<h5>$1</h5>')          // h5标题
                            .replace(/^## (.*$)/gim, '<h4>$1</h4>')           // h4标题
                            .replace(/^# (.*$)/gim, '<h3>$1</h3>')            // h3标题
                            .replace(/\n/g, '<br>');                          // 换行
                        element.innerHTML = formattedText;
                    }
                } else {
                    console.log(`元素 ${index + 1} 没有Markdown内容`);
                }
            });
            
            console.log('Markdown渲染完成');
        }

        // 页面加载完成后渲染Markdown
        document.addEventListener('DOMContentLoaded', function() {
            renderMarkdown();
        });

        // 一键督办功能
        async function superviseTodos(executorId, executorName) {
            const btn = event.target;
            const originalText = btn.innerHTML;
            
            // 禁用按钮，显示加载状态
            btn.disabled = true;
            btn.innerHTML = '⏳ 发送中...';
            
            try {
                // 获取该执行人的所有待办事项
                const executorCard = btn.closest('.executor-card');
                const todoItems = executorCard.querySelectorAll('.todo-item');
                const todos = [];
                
                todoItems.forEach(item => {
                    const title = item.querySelector('.todo-title').textContent.trim();
                    const description = item.querySelector('.todo-description').textContent.trim();
                    const metaSpans = item.querySelectorAll('.todo-meta span');
                    let deadline = '', category = '', projects = '';
                    
                    metaSpans.forEach(span => {
                        const text = span.textContent.trim();
                        if (text.startsWith('⏰')) deadline = text.replace('⏰ ', '');
                        else if (text.startsWith('📂')) category = text.replace('📂 ', '');
                        else if (text.startsWith('🏗️')) projects = text.replace('🏗️ ', '');
                    });
                    
                    todos.push({
                        title: title.replace(/高优先级|中优先级|低优先级/, '').trim(),
                        description,
                        deadline,
                        category,
                        projects
                    });
                });
                
                // 发送督办请求
                // 根据页面协议选择API地址
                const isHttps = window.location.protocol === 'https:';
                const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
                
                let apiBaseUrl;
                if (isHttps && !isLocalhost) {
                    // HTTPS环境，显示提示信息
                    showNotification('督办功能需要在本地环境或配置HTTPS API服务器后使用', 'error');
                    btn.disabled = false;
                    btn.innerHTML = originalText;
                    btn.style.background = '';
                    return;
                } else {
                    // HTTP环境或本地环境，使用HTTP API
                    apiBaseUrl = 'http://10.0.169.21:5001';
                }
                
                console.log('发送督办请求到:', `${apiBaseUrl}/api/supervise_todos`);
                console.log('请求数据:', {
                    executor_id: executorId,
                    executor_name: executorName,
                    todos: todos
                });
                
                const response = await fetch(`${apiBaseUrl}/api/supervise_todos`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        executor_id: executorId,
                        executor_name: executorName,
                        todos: todos
                    })
                });
                
                console.log('API响应状态:', response.status);
                
                const result = await response.json();
                
                if (result.success) {
                    btn.innerHTML = '✅ 已发送';
                    btn.style.background = '#28a745';
                    
                    // 显示成功提示
                    showNotification(`已成功向 ${executorName} 发送 ${todos.length} 个待办事项`, 'success');
                    
                    // 3秒后恢复按钮状态
                    setTimeout(() => {
                        btn.disabled = false;
                        btn.innerHTML = originalText;
                        btn.style.background = '';
                    }, 3000);
                } else {
                    throw new Error(result.error || '发送失败');
                }
                
            } catch (error) {
                console.error('督办发送失败:', error);
                console.error('错误详情:', {
                    name: error.name,
                    message: error.message,
                    stack: error.stack
                });
                
                btn.innerHTML = '❌ 发送失败';
                btn.style.background = '#dc3545';
                
                // 根据错误类型提供更具体的错误信息
                let errorMessage = error.message;
                if (error.name === 'TypeError' && error.message.includes('fetch')) {
                    errorMessage = `网络连接失败，无法连接到API服务器 (${apiBaseUrl})`;
                } else if (error.message.includes('Failed to fetch')) {
                    errorMessage = `API服务器连接失败，请确认服务器是否运行在 ${apiBaseUrl}`;
                } else if (error.message.includes('Mixed Content')) {
                    errorMessage = `安全策略阻止：HTTPS页面无法访问HTTP API服务器 (${apiBaseUrl})，请使用HTTPS API或在本地环境测试`;
                }
                
                showNotification(`向 ${executorName} 发送待办事项失败: ${errorMessage}`, 'error');
                
                // 3秒后恢复按钮状态
                setTimeout(() => {
                    btn.disabled = false;
                    btn.innerHTML = originalText;
                    btn.style.background = '';
                }, 3000);
            }
        }
        


        // 显示通知消息
        function showNotification(message, type = 'info') {
            // 创建通知元素
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 4px;
                color: white;
                font-weight: 500;
                z-index: 1000;
                max-width: 400px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                transition: all 0.3s ease;
            `;
            
            // 根据类型设置样式
            switch(type) {
                case 'success':
                    notification.style.background = '#28a745';
                    break;
                case 'error':
                    notification.style.background = '#dc3545';
                    break;
                default:
                    notification.style.background = '#667eea';
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // 3秒后自动移除
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // 页面加载完成后的初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('日报页面加载完成，待办事项功能已就绪');
            // 渲染Markdown内容
            renderMarkdown();
        });
    </script>
</body>
</html>